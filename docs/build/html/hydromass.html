

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>hydromass package &mdash; hydromass 0.2 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Tutorials" href="tutorials.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> hydromass
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Intro</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hydromass.constants">hydromass.constants module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hydromass.delta">hydromass.delta module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hydromass.deproject">hydromass.deproject module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hydromass.emissivity">hydromass.emissivity module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hydromass.forward">hydromass.forward module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hydromass.functions">hydromass.functions module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hydromass.mhyd">hydromass.mhyd module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hydromass.nonparametric">hydromass.nonparametric module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hydromass.plots">hydromass.plots module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hydromass.pnt">hydromass.pnt module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hydromass.polytropic">hydromass.polytropic module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hydromass.save">hydromass.save module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hydromass.tpdata">hydromass.tpdata module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-hydromass">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">hydromass</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>hydromass package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/hydromass.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="hydromass-package">
<h1>hydromass package<a class="headerlink" href="#hydromass-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-hydromass.constants">
<span id="hydromass-constants-module"></span><h2>hydromass.constants module<a class="headerlink" href="#module-hydromass.constants" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-hydromass.delta">
<span id="hydromass-delta-module"></span><h2>hydromass.delta module<a class="headerlink" href="#module-hydromass.delta" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="hydromass.delta.calc_rdelta_mdelta">
<code class="sig-prename descclassname"><span class="pre">hydromass.delta.</span></code><code class="sig-name descname"><span class="pre">calc_rdelta_mdelta</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/delta.html#calc_rdelta_mdelta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.delta.calc_rdelta_mdelta" title="Permalink to this definition">¶</a></dt>
<dd><p>For a given input overdensity Delta, compute R_delta, M_delta, Mgas_delta, fgas_delta and their uncertainties from a loaded mass model reconstruction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delta</strong> (<em>float</em>) – Overdensity with respect to critical</p></li>
<li><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object containing the results of mass reconstruction run</p></li>
<li><p><strong>model</strong> (class:<cite>hydromass.functions.Model</cite>) – <a class="reference internal" href="#hydromass.functions.Model" title="hydromass.functions.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.functions.Model</span></code></a> object defining the mass model</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – If plot=True, returns a matplotlib.pyplot.figure drawing the mass distribution of the chains at R_delta. In case plot=False the function returns an empty figure.</p></li>
<li><p><strong>rmin</strong> (<em>float</em>) – Minimum radius where to search for the overdensity radius (in kpc). Defaults to 100</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – Maximum radius where to search for the overdensity radius (in kpc). Defaults to 4000</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary containing values of R_delta, M_delta, Mgas_delta, Fgas_delta and their 1-sigma percentiles, and figure if plot=True</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>dict{12xfloat}</p></li>
<li><p>matplotlib.pyplot.figure</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.delta.calc_rdelta_mdelta_GP">
<code class="sig-prename descclassname"><span class="pre">hydromass.delta.</span></code><code class="sig-name descname"><span class="pre">calc_rdelta_mdelta_GP</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/delta.html#calc_rdelta_mdelta_GP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.delta.calc_rdelta_mdelta_GP" title="Permalink to this definition">¶</a></dt>
<dd><p>For a given input overdensity Delta, compute R_delta, M_delta, Mgas_delta, fgas_delta and their uncertainties from a loaded non-parametric GP reconstruction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delta</strong> (<em>float</em>) – Overdensity with respect to critical</p></li>
<li><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object containing the results of mass reconstruction run</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – If plot=True, returns a matplotlib.pyplot.figure drawing the mass distribution of the chains at R_delta. In case plot=False the function returns an empty figure.</p></li>
<li><p><strong>rmin</strong> (<em>float</em>) – Minimum radius where to search for the overdensity radius (in kpc). Defaults to 100</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – Maximum radius where to search for the overdensity radius (in kpc). Defaults to 4000</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary containing values R_delta, M_delta, Mgas_delta, Fgas_delta and their 1-sigma percentiles, figure if plot=True</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>dict{12xfloat}</p></li>
<li><p>matplotlib.pyplot.figure</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.delta.calc_rdelta_mdelta_forward">
<code class="sig-prename descclassname"><span class="pre">hydromass.delta.</span></code><code class="sig-name descname"><span class="pre">calc_rdelta_mdelta_forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/delta.html#calc_rdelta_mdelta_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.delta.calc_rdelta_mdelta_forward" title="Permalink to this definition">¶</a></dt>
<dd><p>For a given input overdensity Delta, compute R_delta, M_delta, Mgas_delta, fgas_delta and their uncertainties from a loaded Forward mass reconstruction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delta</strong> (<em>float</em>) – Overdensity with respect to critical</p></li>
<li><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object containing the results of mass reconstruction run</p></li>
<li><p><strong>Forward</strong> (class:<cite>hydromass.forward.Forward</cite>) – <a class="reference internal" href="#hydromass.forward.Forward" title="hydromass.forward.Forward"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.forward.Forward</span></code></a> model</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – If plot=True, returns a matplotlib.pyplot.figure drawing the mass distribution of the chains at R_delta. In case plot=False the function returns an empty figure.</p></li>
<li><p><strong>rmin</strong> (<em>float</em>) – Minimum radius where to search for the overdensity radius (in kpc). Defaults to 100</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – Maximum radius where to search for the overdensity radius (in kpc). Defaults to 4000</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary containing values R_delta, M_delta, Mgas_delta, Fgas_delta and their 1-sigma percentiles, figure if plot=True</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>dict{12xfloat}</p></li>
<li><p>matplotlib.pyplot.figure</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.delta.calc_rdelta_mdelta_polytropic">
<code class="sig-prename descclassname"><span class="pre">hydromass.delta.</span></code><code class="sig-name descname"><span class="pre">calc_rdelta_mdelta_polytropic</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Polytropic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/delta.html#calc_rdelta_mdelta_polytropic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.delta.calc_rdelta_mdelta_polytropic" title="Permalink to this definition">¶</a></dt>
<dd><p>For a given input overdensity Delta, compute R_delta, M_delta, Mgas_delta, fgas_delta and their uncertainties from a loaded Forward mass reconstruction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>delta</strong> (<em>float</em>) – Overdensity with respect to critical</p></li>
<li><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object containing the results of mass reconstruction run</p></li>
<li><p><strong>Polytropic</strong> (class:<cite>hydromass.polytropic.Polytropic</cite>) – <a class="reference internal" href="#hydromass.polytropic.Polytropic" title="hydromass.polytropic.Polytropic"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.polytropic.Polytropic</span></code></a> model</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – If plot=True, returns a matplotlib.pyplot.figure drawing the mass distribution of the chains at R_delta. In case plot=False the function returns an empty figure.</p></li>
<li><p><strong>rmin</strong> (<em>float</em>) – Minimum radius where to search for the overdensity radius (in kpc). Defaults to 100</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – Maximum radius where to search for the overdensity radius (in kpc). Defaults to 4000</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary containing values R_delta, M_delta, Mgas_delta, Fgas_delta and their 1-sigma percentiles, figure if plot=True</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>dict{12xfloat}</p></li>
<li><p>matplotlib.pyplot.figure</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.delta.delta_func">
<code class="sig-prename descclassname"><span class="pre">hydromass.delta.</span></code><code class="sig-name descname"><span class="pre">delta_func</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/delta.html#delta_func"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.delta.delta_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Return profile of overdensity Delta with respect to critical density for a given input mass model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> (<em>numpy.ndarray</em><em> or </em><em>float</em>) – Radii in kpc</p></li>
<li><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object containing mass reconstruction</p></li>
<li><p><strong>model</strong> (class:<cite>hydromass.function.Model</cite>) – <a class="reference internal" href="#hydromass.functions.Model" title="hydromass.functions.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.functions.Model</span></code></a> object containing the definition of the mass model</p></li>
<li><p><strong>pars</strong> (<em>numpy.ndarray</em>) – Parameter vector to be passed to the mass model</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Overdensity as a function of radius</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.delta.mbar_overdens">
<code class="sig-prename descclassname"><span class="pre">hydromass.delta.</span></code><code class="sig-name descname"><span class="pre">mbar_overdens</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rmax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coefs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_bkg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rout_m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/delta.html#mbar_overdens"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.delta.mbar_overdens" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute overdensity of baryonic mass with respect to critical</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rmax</strong> (<em>float</em>) – Maximum radius of Mgas calculation</p></li>
<li><p><strong>coefs</strong> (<em>numpy.ndarray</em>) – Coefficients describing the density profile</p></li>
<li><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object containing reconstruction</p></li>
<li><p><strong>fit_bkg</strong> (<em>bool</em>) – Set whether the background was jointly fitted (True) or subtracted (False). Defaults to False.</p></li>
<li><p><strong>rout_m</strong> (<em>numpy.ndarray</em>) – If a radially dependent conversion factor is used, radius grid on which the conversion factors were computed</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Radius, Overdensity of Mgas</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray, numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.delta.mgas_delta">
<code class="sig-prename descclassname"><span class="pre">hydromass.delta.</span></code><code class="sig-name descname"><span class="pre">mgas_delta</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rdelta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coefs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_bkg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rout_m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/delta.html#mgas_delta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.delta.mgas_delta" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute Mgas at an input radius R_delta</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rdelta</strong> (<em>float</em>) – R_delta in kpc</p></li>
<li><p><strong>coefs</strong> (<em>numpy.ndarray</em>) – Coefficients describing the density profile</p></li>
<li><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object containing reconstruction</p></li>
<li><p><strong>fit_bkg</strong> (<em>bool</em>) – Set whether the background was jointly fitted (True) or subtracted (False). Defaults to False.</p></li>
<li><p><strong>rout_m</strong> (<em>numpy.ndarray</em>) – If a radially dependent conversion factor is used, radius grid on which the conversion factors were computed</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gas mass evaluated inside rdelta</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.delta.write_all_mdelta">
<code class="sig-prename descclassname"><span class="pre">hydromass.delta.</span></code><code class="sig-name descname"><span class="pre">write_all_mdelta</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/delta.html#write_all_mdelta"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.delta.write_all_mdelta" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the results of the mass reconstruction run evaluated at overdensities 2500, 1000, 500, and 200 to an output file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> (<em>class Mhyd</em>) – Mhyd object containing the result of mass reconstruction run</p></li>
<li><p><strong>model</strong> (<em>class Model</em>) – Model object defining the mass model</p></li>
<li><p><strong>outfile</strong> (<em>str</em>) – Name of output file. In case outfile=None (default), the function writes to Mhyd.dir/’name’.jou , with ‘name’ the name of the mass model.</p></li>
<li><p><strong>rmin</strong> (<em>float</em>) – Minimum radius where to search for the overdensity radii (in kpc). Defaults to 100</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – Maximum radius where to search for the overdensity radii (in kpc). Defaults to 4000</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.delta.write_all_mdelta_GP">
<code class="sig-prename descclassname"><span class="pre">hydromass.delta.</span></code><code class="sig-name descname"><span class="pre">write_all_mdelta_GP</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/delta.html#write_all_mdelta_GP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.delta.write_all_mdelta_GP" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the results of the mass reconstruction run evaluated at overdensities 2500, 1000, 500, and 200 to an output file. In case the fitted model is noisy and shows local (or non-local) reversals, the procedure can fail if the function Delta(r)-Delta does not change sign over the range of interest. In this case, consider changing the values of rmin and rmax</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> (<em>class Mhyd</em>) – Mhyd object containing the result of mass reconstruction run</p></li>
<li><p><strong>outfile</strong> (<em>str</em>) – Name of output file. In case outfile=None (default), the function writes to Mhyd.dir/’name’.jou , with ‘name’ the name of the mass model.</p></li>
<li><p><strong>rmin</strong> (<em>float</em>) – Minimum radius where to search for the overdensity radii (in kpc). Defaults to 100</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – Maximum radius where to search for the overdensity radii (in kpc). Defaults to 4000</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.delta.write_all_mdelta_forward">
<code class="sig-prename descclassname"><span class="pre">hydromass.delta.</span></code><code class="sig-name descname"><span class="pre">write_all_mdelta_forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/delta.html#write_all_mdelta_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.delta.write_all_mdelta_forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the results of the mass reconstruction run evaluated at overdensities 2500, 1000, 500, and 200 to an output file. In case the fitted model is noisy and shows local (or non-local) reversals, the procedure can fail if the function Delta(r)-Delta does not change sign over the range of interest. In this case, consider changing the values of rmin and rmax</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> (<em>class Mhyd</em>) – Mhyd object containing the result of mass reconstruction run</p></li>
<li><p><strong>outfile</strong> (<em>str</em>) – Name of output file. In case outfile=None (default), the function writes to Mhyd.dir/’name’.jou , with ‘name’ the name of the mass model.</p></li>
<li><p><strong>rmin</strong> (<em>float</em>) – Minimum radius where to search for the overdensity radii (in kpc). Defaults to 100</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – Maximum radius where to search for the overdensity radii (in kpc). Defaults to 4000</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-hydromass.deproject">
<span id="hydromass-deproject-module"></span><h2>hydromass.deproject module<a class="headerlink" href="#module-hydromass.deproject" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="hydromass.deproject.MyDeprojVol">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydromass.deproject.</span></code><code class="sig-name descname"><span class="pre">MyDeprojVol</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">radin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radot</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/deproject.html#MyDeprojVol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.deproject.MyDeprojVol" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Mydeproj</p>
<dl class="py method">
<dt id="hydromass.deproject.MyDeprojVol.deproj_vol">
<code class="sig-name descname"><span class="pre">deproj_vol</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/deproject.html#MyDeprojVol.deproj_vol"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.deproject.MyDeprojVol.deproj_vol" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="hydromass.deproject.calc_density_operator">
<code class="sig-prename descclassname"><span class="pre">hydromass.deproject.</span></code><code class="sig-name descname"><span class="pre">calc_density_operator</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpcp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">withbkg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/deproject.html#calc_density_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.deproject.calc_density_operator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.deproject.calc_grad_operator">
<code class="sig-prename descclassname"><span class="pre">hydromass.deproject.</span></code><code class="sig-name descname"><span class="pre">calc_grad_operator</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpcp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">withbkg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/deproject.html#calc_grad_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.deproject.calc_grad_operator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.deproject.calc_int_operator">
<code class="sig-prename descclassname"><span class="pre">hydromass.deproject.</span></code><code class="sig-name descname"><span class="pre">calc_int_operator</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/deproject.html#calc_int_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.deproject.calc_int_operator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.deproject.calc_linear_operator">
<code class="sig-prename descclassname"><span class="pre">hydromass.deproject.</span></code><code class="sig-name descname"><span class="pre">calc_linear_operator</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sourcereg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/deproject.html#calc_linear_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.deproject.calc_linear_operator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.deproject.calc_sb_operator">
<code class="sig-prename descclassname"><span class="pre">hydromass.deproject.</span></code><code class="sig-name descname"><span class="pre">calc_sb_operator</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sourcereg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">withbkg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/deproject.html#calc_sb_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.deproject.calc_sb_operator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.deproject.calc_sb_operator_psf">
<code class="sig-prename descclassname"><span class="pre">hydromass.deproject.</span></code><code class="sig-name descname"><span class="pre">calc_sb_operator_psf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sourcereg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">withbkg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/deproject.html#calc_sb_operator_psf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.deproject.calc_sb_operator_psf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.deproject.list_params">
<code class="sig-prename descclassname"><span class="pre">hydromass.deproject.</span></code><code class="sig-name descname"><span class="pre">list_params</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sourcereg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbetas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/deproject.html#list_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.deproject.list_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.deproject.list_params_density">
<code class="sig-prename descclassname"><span class="pre">hydromass.deproject.</span></code><code class="sig-name descname"><span class="pre">list_params_density</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sourcereg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kpcp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbetas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/deproject.html#list_params_density"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.deproject.list_params_density" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-hydromass.emissivity">
<span id="hydromass-emissivity-module"></span><h2>hydromass.emissivity module<a class="headerlink" href="#module-hydromass.emissivity" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="hydromass.emissivity.calc_emissivity">
<code class="sig-prename descclassname"><span class="pre">hydromass.emissivity.</span></code><code class="sig-name descname"><span class="pre">calc_emissivity</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cosmo</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abund</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'angr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ehigh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/emissivity.html#calc_emissivity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.emissivity.calc_emissivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Function calc_emissivity, computes scaling factor between count rate and APEC/MEKAL norm using XSPEC. The tool performs an XSPEC simulation of an absorbed APEC model with parameters set by the user, and computes the expected count rate in the band of interest corresponding to an APEC normalization of unity. The corresponding number is then used as conversion between count rate and emission measure for the hydrostatic mass reconstruction step. Note that since the computed count rates are corrected for vignetting through the exposure map, the provided ARF should correspond to the on-axis (unvignetted) effective area.
Requires that XSPEC be in path</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cosmo</strong> (class:<cite>astropy.cosmology</cite>) – Astropy cosmology object containing the definition of the used cosmology.</p></li>
<li><p><strong>z</strong> (<em>float</em>) – Source redshift</p></li>
<li><p><strong>nh</strong> (<em>float</em>) – Source NH in units of 1e22 cm**(-2)</p></li>
<li><p><strong>kt</strong> (<em>float</em>) – Source temperature in keV</p></li>
<li><p><strong>rmf</strong> (<em>str</em>) – Path to response file (RMF/RSP)</p></li>
<li><p><strong>abund</strong> (<em>str</em>) – Solar abundance table in XSPEC format. Defaults to “angr”</p></li>
<li><p><strong>Z</strong> (<em>float</em>) – Metallicity with respect to solar. Defaults to 0.3</p></li>
<li><p><strong>elow</strong> (<em>float</em>) – Low-energy bound of the input image in keV. Defaults to 0.5</p></li>
<li><p><strong>ehigh</strong> (<em>float</em>) – High-energy bound of the input image in keV. Defaults to 2.0</p></li>
<li><p><strong>arf</strong> (<em>str</em>) – Path to on-axis ARF (optional, in case response file is RMF)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Conversion factor</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.emissivity.is_tool">
<code class="sig-prename descclassname"><span class="pre">hydromass.emissivity.</span></code><code class="sig-name descname"><span class="pre">is_tool</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/emissivity.html#is_tool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.emissivity.is_tool" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether <cite>name</cite> is on PATH.</p>
</dd></dl>

</div>
<div class="section" id="module-hydromass.forward">
<span id="hydromass-forward-module"></span><h2>hydromass.forward module<a class="headerlink" href="#module-hydromass.forward" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="hydromass.forward.Forward">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydromass.forward.</span></code><code class="sig-name descname"><span class="pre">Forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/forward.html#Forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.forward.Forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for definition of forward model to the pressure using a GNFW model</p>
</dd></dl>

<dl class="py function">
<dt id="hydromass.forward.P_forw_from_samples">
<code class="sig-prename descclassname"><span class="pre">hydromass.forward.</span></code><code class="sig-name descname"><span class="pre">P_forw_from_samples</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/forward.html#P_forw_from_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.forward.P_forw_from_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute model pressure profile from Forward Mhyd reconstruction evaluated at the reference SZ radii</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> – mhyd.Mhyd object including the reconstruction</p></li>
<li><p><strong>model</strong> – mhyd.Model object defining the mass model</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Median pressure, Lower 1-sigma percentile, Upper 1-sigma percentile</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.forward.Run_Forward_PyMC3">
<code class="sig-prename descclassname"><span class="pre">hydromass.forward.</span></code><code class="sig-name descname"><span class="pre">Run_Forward_PyMC3</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkglim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmcmc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_bkg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samplefile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbetas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">find_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/forward.html#Run_Forward_PyMC3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.forward.Run_Forward_PyMC3" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> – </p></li>
<li><p><strong>bkglim</strong> – </p></li>
<li><p><strong>nmcmc</strong> – </p></li>
<li><p><strong>fit_bkg</strong> – </p></li>
<li><p><strong>back</strong> – </p></li>
<li><p><strong>samplefile</strong> – </p></li>
<li><p><strong>nrc</strong> – </p></li>
<li><p><strong>nbetas</strong> – </p></li>
<li><p><strong>min_beta</strong> – </p></li>
<li><p><strong>tune</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.forward.der_lnP_np">
<code class="sig-prename descclassname"><span class="pre">hydromass.forward.</span></code><code class="sig-name descname"><span class="pre">der_lnP_np</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/forward.html#der_lnP_np"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.forward.der_lnP_np" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.forward.gnfw_np">
<code class="sig-prename descclassname"><span class="pre">hydromass.forward.</span></code><code class="sig-name descname"><span class="pre">gnfw_np</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/forward.html#gnfw_np"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.forward.gnfw_np" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.forward.gnfw_pm">
<code class="sig-prename descclassname"><span class="pre">hydromass.forward.</span></code><code class="sig-name descname"><span class="pre">gnfw_pm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alfa</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/forward.html#gnfw_pm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.forward.gnfw_pm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.forward.kt_forw_from_samples">
<code class="sig-prename descclassname"><span class="pre">hydromass.forward.</span></code><code class="sig-name descname"><span class="pre">kt_forw_from_samples</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/forward.html#kt_forw_from_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.forward.kt_forw_from_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute model temperature profile from Forward Mhyd reconstruction evaluated at reference X-ray temperature radii</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> – mhyd.Mhyd object including the reconstruction</p></li>
<li><p><strong>model</strong> – mhyd.Model object defining the mass model</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Median temperature, Lower 1-sigma percentile, Upper 1-sigma percentile</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.forward.mass_forw_from_samples">
<code class="sig-prename descclassname"><span class="pre">hydromass.forward.</span></code><code class="sig-name descname"><span class="pre">mass_forw_from_samples</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/forward.html#mass_forw_from_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.forward.mass_forw_from_samples" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.forward.prof_forw_hires">
<code class="sig-prename descclassname"><span class="pre">hydromass.forward.</span></code><code class="sig-name descname"><span class="pre">prof_forw_hires</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/forward.html#prof_forw_hires"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.forward.prof_forw_hires" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute best-fitting profiles and error envelopes from fitted data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> – (hydromass.Mhyd) Object containing results of mass reconstruction</p></li>
<li><p><strong>model</strong> – </p></li>
<li><p><strong>nmore</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-hydromass.functions">
<span id="hydromass-functions-module"></span><h2>hydromass.functions module<a class="headerlink" href="#module-hydromass.functions" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="hydromass.functions.ArcTan">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydromass.functions.</span></code><code class="sig-name descname"><span class="pre">ArcTan</span></code><a class="reference internal" href="_modules/hydromass/functions.html#ArcTan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.functions.ArcTan" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">theano.graph.op.Op</span></code></p>
<p>Theano arctan class</p>
<dl class="py method">
<dt id="hydromass.functions.ArcTan.grad">
<code class="sig-name descname"><span class="pre">grad</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/functions.html#ArcTan.grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.functions.ArcTan.grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a graph for the gradient with respect to each input variable.</p>
<p>Each returned <cite>Variable</cite> represents the gradient with respect to that
input computed based on the symbolic gradients with respect to each
output. If the output is not differentiable with respect to an input,
then this method should return an instance of type <cite>NullType</cite> for that
input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<em>list of Variable</em>) – The input variables.</p></li>
<li><p><strong>output_grads</strong> (<em>list of Variable</em>) – The gradients of the output variables.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>grads</strong> – The gradients with respect to each <cite>Variable</cite> in <cite>inputs</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of Variable</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hydromass.functions.ArcTan.itypes">
<code class="sig-name descname"><span class="pre">itypes</span></code><em class="property"> <span class="pre">=</span> <span class="pre">[TensorType(float64,</span> <span class="pre">vector)]</span></em><a class="headerlink" href="#hydromass.functions.ArcTan.itypes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydromass.functions.ArcTan.otypes">
<code class="sig-name descname"><span class="pre">otypes</span></code><em class="property"> <span class="pre">=</span> <span class="pre">[TensorType(float64,</span> <span class="pre">vector)]</span></em><a class="headerlink" href="#hydromass.functions.ArcTan.otypes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="hydromass.functions.ArcTan.perform">
<code class="sig-name descname"><span class="pre">perform</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/functions.html#ArcTan.perform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.functions.ArcTan.perform" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the function on the inputs and put the variables in the output storage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> (<em>Apply</em>) – The symbolic <cite>Apply</cite> node that represents this computation.</p></li>
<li><p><strong>inputs</strong> (<em>Sequence</em>) – Immutable sequence of non-symbolic/numeric inputs.  These
are the values of each <cite>Variable</cite> in <cite>node.inputs</cite>.</p></li>
<li><p><strong>output_storage</strong> (<em>list of list</em>) – List of mutable single-element lists (do not change the length of
these lists).  Each sub-list corresponds to value of each
<cite>Variable</cite> in <cite>node.outputs</cite>.  The primary purpose of this method
is to set the values of these sub-lists.</p></li>
<li><p><strong>params</strong> (<em>tuple</em>) – A tuple containing the values of each entry in <cite>__props__</cite>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The <cite>output_storage</cite> list might contain data. If an element of
output_storage is not <cite>None</cite>, it has to be of the right type, for
instance, for a <cite>TensorVariable</cite>, it has to be a NumPy <cite>ndarray</cite>
with the right number of dimensions and the correct dtype.
Its shape and stride pattern can be arbitrary. It is not
guaranteed that such pre-set values were produced by a previous call to
this <cite>Op.perform</cite>; they could’ve been allocated by another
<cite>Op</cite>’s <cite>perform</cite> method.
A <cite>Op</cite> is free to reuse <cite>output_storage</cite> as it sees fit, or to
discard it and allocate new memory.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hydromass.functions.EinastoFx">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydromass.functions.</span></code><code class="sig-name descname"><span class="pre">EinastoFx</span></code><a class="reference internal" href="_modules/hydromass/functions.html#EinastoFx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.functions.EinastoFx" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">theano.graph.op.Op</span></code></p>
<p>Theano class implementing the 2-parameter Einasto model with fixed mu=5.0</p>
<dl class="py method">
<dt id="hydromass.functions.EinastoFx.grad">
<code class="sig-name descname"><span class="pre">grad</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">g</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/functions.html#EinastoFx.grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.functions.EinastoFx.grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a graph for the gradient with respect to each input variable.</p>
<p>Each returned <cite>Variable</cite> represents the gradient with respect to that
input computed based on the symbolic gradients with respect to each
output. If the output is not differentiable with respect to an input,
then this method should return an instance of type <cite>NullType</cite> for that
input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> (<em>list of Variable</em>) – The input variables.</p></li>
<li><p><strong>output_grads</strong> (<em>list of Variable</em>) – The gradients of the output variables.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>grads</strong> – The gradients with respect to each <cite>Variable</cite> in <cite>inputs</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of Variable</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="hydromass.functions.EinastoFx.itypes">
<code class="sig-name descname"><span class="pre">itypes</span></code><em class="property"> <span class="pre">=</span> <span class="pre">[TensorType(float64,</span> <span class="pre">vector)]</span></em><a class="headerlink" href="#hydromass.functions.EinastoFx.itypes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="hydromass.functions.EinastoFx.otypes">
<code class="sig-name descname"><span class="pre">otypes</span></code><em class="property"> <span class="pre">=</span> <span class="pre">[TensorType(float64,</span> <span class="pre">vector)]</span></em><a class="headerlink" href="#hydromass.functions.EinastoFx.otypes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="hydromass.functions.EinastoFx.perform">
<code class="sig-name descname"><span class="pre">perform</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/functions.html#EinastoFx.perform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.functions.EinastoFx.perform" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the function on the inputs and put the variables in the output storage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>node</strong> (<em>Apply</em>) – The symbolic <cite>Apply</cite> node that represents this computation.</p></li>
<li><p><strong>inputs</strong> (<em>Sequence</em>) – Immutable sequence of non-symbolic/numeric inputs.  These
are the values of each <cite>Variable</cite> in <cite>node.inputs</cite>.</p></li>
<li><p><strong>output_storage</strong> (<em>list of list</em>) – List of mutable single-element lists (do not change the length of
these lists).  Each sub-list corresponds to value of each
<cite>Variable</cite> in <cite>node.outputs</cite>.  The primary purpose of this method
is to set the values of these sub-lists.</p></li>
<li><p><strong>params</strong> (<em>tuple</em>) – A tuple containing the values of each entry in <cite>__props__</cite>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The <cite>output_storage</cite> list might contain data. If an element of
output_storage is not <cite>None</cite>, it has to be of the right type, for
instance, for a <cite>TensorVariable</cite>, it has to be a NumPy <cite>ndarray</cite>
with the right number of dimensions and the correct dtype.
Its shape and stride pattern can be arbitrary. It is not
guaranteed that such pre-set values were produced by a previous call to
this <cite>Op.perform</cite>; they could’ve been allocated by another
<cite>Op</cite>’s <cite>perform</cite> method.
A <cite>Op</cite> is free to reuse <cite>output_storage</cite> as it sees fit, or to
discard it and allocate new memory.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hydromass.functions.Model">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydromass.functions.</span></code><code class="sig-name descname"><span class="pre">Model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">massmod</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/functions.html#Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.functions.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py function">
<dt id="hydromass.functions.f_bur_np">
<code class="sig-prename descclassname"><span class="pre">hydromass.functions.</span></code><code class="sig-name descname"><span class="pre">f_bur_np</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/functions.html#f_bur_np"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.functions.f_bur_np" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.functions.f_bur_pm">
<code class="sig-prename descclassname"><span class="pre">hydromass.functions.</span></code><code class="sig-name descname"><span class="pre">f_bur_pm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/functions.html#f_bur_pm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.functions.f_bur_pm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.functions.f_ein2_np">
<code class="sig-prename descclassname"><span class="pre">hydromass.functions.</span></code><code class="sig-name descname"><span class="pre">f_ein2_np</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/functions.html#f_ein2_np"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.functions.f_ein2_np" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.functions.f_ein2_pm">
<code class="sig-prename descclassname"><span class="pre">hydromass.functions.</span></code><code class="sig-name descname"><span class="pre">f_ein2_pm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/functions.html#f_ein2_pm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.functions.f_ein2_pm" title="Permalink to this definition">¶</a></dt>
<dd><p>Theano function returning the 2-parameter Einasto model for a given set of parameters.</p>
<div class="math notranslate nohighlight">
\[\rho(r) = \rho_s \exp \left[ -2\mu \left( \left( \frac{r}{r_s} \right) ^ {1 /\mu} - 1 \right) \right]\]</div>
<p>with :math:mu=5.0</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xout</strong> – Radius</p></li>
<li><p><strong>c200</strong> – concentration</p></li>
<li><p><strong>r200</strong> – Scale radius</p></li>
<li><p><strong>delta</strong> – Overdensity</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Enclosed mass</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.functions.f_ein3_np">
<code class="sig-prename descclassname"><span class="pre">hydromass.functions.</span></code><code class="sig-name descname"><span class="pre">f_ein3_np</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/functions.html#f_ein3_np"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.functions.f_ein3_np" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.functions.f_ein3_pm">
<code class="sig-prename descclassname"><span class="pre">hydromass.functions.</span></code><code class="sig-name descname"><span class="pre">f_ein3_pm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/functions.html#f_ein3_pm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.functions.f_ein3_pm" title="Permalink to this definition">¶</a></dt>
<dd><p>Theano function for the 3-parameter Einasto mass model,</p>
<div class="math notranslate nohighlight">
\[\rho(r) = \rho_s \exp \left[ -2\mu \left( \left( \frac{r}{r_s} \right) ^ {1 /\mu} - 1 \right) \right]\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xout</strong> – Radius</p></li>
<li><p><strong>c200</strong> – concentration</p></li>
<li><p><strong>r200</strong> – Scale radius</p></li>
<li><p><strong>mu</strong> – Einasto mu</p></li>
<li><p><strong>delta</strong> – Overdensity</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Enclosed mass</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.functions.f_ein_mu">
<code class="sig-prename descclassname"><span class="pre">hydromass.functions.</span></code><code class="sig-name descname"><span class="pre">f_ein_mu</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/functions.html#f_ein_mu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.functions.f_ein_mu" title="Permalink to this definition">¶</a></dt>
<dd><p>Einasto mass model as a function of mu=1/alpha (see Mamon &amp; Lokas 2005)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>float</em>) – Scaled radius</p></li>
<li><p><strong>mu</strong> (<em>float</em>) – Einasto mu</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Scaled mass profile</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.functions.f_ein_mu_der">
<code class="sig-prename descclassname"><span class="pre">hydromass.functions.</span></code><code class="sig-name descname"><span class="pre">f_ein_mu_der</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/functions.html#f_ein_mu_der"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.functions.f_ein_mu_der" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.functions.f_her_np">
<code class="sig-prename descclassname"><span class="pre">hydromass.functions.</span></code><code class="sig-name descname"><span class="pre">f_her_np</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/functions.html#f_her_np"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.functions.f_her_np" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.functions.f_her_pm">
<code class="sig-prename descclassname"><span class="pre">hydromass.functions.</span></code><code class="sig-name descname"><span class="pre">f_her_pm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/functions.html#f_her_pm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.functions.f_her_pm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.functions.f_iso_np">
<code class="sig-prename descclassname"><span class="pre">hydromass.functions.</span></code><code class="sig-name descname"><span class="pre">f_iso_np</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/functions.html#f_iso_np"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.functions.f_iso_np" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.functions.f_iso_pm">
<code class="sig-prename descclassname"><span class="pre">hydromass.functions.</span></code><code class="sig-name descname"><span class="pre">f_iso_pm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/functions.html#f_iso_pm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.functions.f_iso_pm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.functions.f_nfw_np">
<code class="sig-prename descclassname"><span class="pre">hydromass.functions.</span></code><code class="sig-name descname"><span class="pre">f_nfw_np</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/functions.html#f_nfw_np"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.functions.f_nfw_np" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.functions.f_nfw_pm">
<code class="sig-prename descclassname"><span class="pre">hydromass.functions.</span></code><code class="sig-name descname"><span class="pre">f_nfw_pm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/functions.html#f_nfw_pm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.functions.f_nfw_pm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-hydromass.mhyd">
<span id="hydromass-mhyd-module"></span><h2>hydromass.mhyd module<a class="headerlink" href="#module-hydromass.mhyd" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="hydromass.mhyd.Mhyd">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydromass.mhyd.</span></code><code class="sig-name descname"><span class="pre">Mhyd</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sbprofile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sz_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_abund</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'angr'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/mhyd.html#Mhyd"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.mhyd.Mhyd" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The Mhyd class is the core class of hydromass. It allows the user to pass one or more datasets to be fitted, chose the mass reconstruction method, set options like change cosmology, Solar abundance table, NUTS options, model choice, and more.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sbprofile</strong> (class:<cite>pyproffit.profextract.Profile</cite>) – A pyproffit Profile object (<a class="reference external" href="https://pyproffit.readthedocs.io/en/latest/pyproffit.html#module-pyproffit.profextract">https://pyproffit.readthedocs.io/en/latest/pyproffit.html#module-pyproffit.profextract</a>) including the surface brightness data</p></li>
<li><p><strong>spec_data</strong> (class:<cite>hydromass.tpdata.SpecData</cite>) – A <a class="reference internal" href="#hydromass.tpdata.SpecData" title="hydromass.tpdata.SpecData"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.tpdata.SpecData</span></code></a> object including a spectroscopic X-ray temperature profile and its associated uncertainties</p></li>
<li><p><strong>sz_data</strong> (class:<cite>hydromass.tpdata.SZData</cite>) – A <a class="reference internal" href="#hydromass.tpdata.SZData" title="hydromass.tpdata.SZData"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.tpdata.SZData</span></code></a> object containing an SZ pressure profile and its covariance matrix</p></li>
<li><p><strong>directory</strong> (<em>str</em>) – Name of output file directory. Defaults to ‘mhyd’</p></li>
<li><p><strong>redshift</strong> (<em>float</em>) – Source redshift</p></li>
<li><p><strong>cosmo</strong> (class:<cite>astropy.cosmology</cite>) – Astropy cosmological model</p></li>
<li><p><strong>f_abund</strong> (<em>str</em>) – Solar abundance table. Available are ‘angr’, ‘aspl’, and ‘grsa’. Defaults to ‘angr’</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="hydromass.mhyd.Mhyd.SaveForward">
<code class="sig-name descname"><span class="pre">SaveForward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/mhyd.html#Mhyd.SaveForward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.mhyd.Mhyd.SaveForward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="hydromass.mhyd.Mhyd.SaveGP">
<code class="sig-name descname"><span class="pre">SaveGP</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/mhyd.html#Mhyd.SaveGP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.mhyd.Mhyd.SaveGP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="hydromass.mhyd.Mhyd.SaveModel">
<code class="sig-name descname"><span class="pre">SaveModel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/mhyd.html#Mhyd.SaveModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.mhyd.Mhyd.SaveModel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="hydromass.mhyd.Mhyd.emissivity">
<code class="sig-name descname"><span class="pre">emissivity</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abund</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'angr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ehigh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/mhyd.html#Mhyd.emissivity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.mhyd.Mhyd.emissivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the conversion between count rate and emissivity using XSPEC by run the <a class="reference internal" href="#hydromass.emissivity.calc_emissivity" title="hydromass.emissivity.calc_emissivity"><code class="xref py py-func docutils literal notranslate"><span class="pre">hydromass.emissivity.calc_emissivity()</span></code></a> function. Requires XSPEC to be available in PATH.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nh</strong> (<em>float</em>) – Source NH in units of 1e22 cm**(-2)</p></li>
<li><p><strong>kt</strong> (<em>float</em>) – Source temperature in keV</p></li>
<li><p><strong>rmf</strong> (<em>str</em>) – Path to response file (RMF/RSP)</p></li>
<li><p><strong>abund</strong> (<em>str</em>) – Solar abundance table in XSPEC format. Defaults to “angr”</p></li>
<li><p><strong>Z</strong> (<em>float</em>) – Metallicity with respect to solar. Defaults to 0.3</p></li>
<li><p><strong>elow</strong> (<em>float</em>) – Low-energy bound of the input image in keV. Defaults to 0.5</p></li>
<li><p><strong>ehigh</strong> (<em>float</em>) – High-energy bound of the input image in keV. Defaults to 2.0</p></li>
<li><p><strong>arf</strong> (<em>str</em>) – Path to on-axis ARF (optional, in case response file is RMF)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hydromass.mhyd.Mhyd.run">
<code class="sig-name descname"><span class="pre">run</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkglim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmcmc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_bkg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samplefile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbetas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dmonly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mstar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">find_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pnt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/mhyd.html#Mhyd.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.mhyd.Mhyd.run" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (class:<cite>hydromass.functions.Model</cite>) – A <a class="reference internal" href="#hydromass.functions.Model" title="hydromass.functions.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.functions.Model</span></code></a> object including the chosen mass model and its input values (mandatory input)</p></li>
<li><p><strong>bkglim</strong> (<em>float</em>) – Limit (in arcmin) out to which the SB data will be fitted; if None then the whole range is considered. Defaults to None.</p></li>
<li><p><strong>nmcmc</strong> (<em>int</em>) – Number of PyMC3 steps. Defaults to 1000</p></li>
<li><p><strong>fit_bkg</strong> (<em>bool</em>) – Choose whether the counts and the background will be fitted on-the-fly using a Poisson model (fit_bkg=True) or if the surface brightness will be fitted, in which case it is assumed that the background has already been subtracted and Gaussian likelihood will be used (default = False)</p></li>
<li><p><strong>back</strong> (<em>float</em>) – Input value for the background. If None then the mean surface brightness in the region outside “bkglim” is used. Relevant only if fit_bkg = True. Defaults to None.</p></li>
<li><p><strong>samplefile</strong> (<em>str</em>) – Name of ASCII file to output the final PyMC3 samples</p></li>
<li><p><strong>nrc</strong> (<em>int</em>) – Number of core radii values to set up the multiscale model. Defaults to the number of data points / 4</p></li>
<li><p><strong>nbetas</strong> (<em>int</em>) – Number of beta values to set up the multiscale model (default = 6)</p></li>
<li><p><strong>min_beta</strong> (<em>float</em>) – Minimum beta value (default = 0.6)</p></li>
<li><p><strong>nmore</strong> (<em>int</em>) – Number of points to the define the fine grid onto which the mass model and the integration are performed, i.e. for one spectroscopic/SZ value, how many grid points will be defined. Defaults to 5.</p></li>
<li><p><strong>p0_prior</strong> (<em>numpy.ndarray</em>) – Set of two values defining the mean and standard deviation of the Gaussian prior on p0. If None, the code attempts to determine the value of P0 using the <a class="reference internal" href="#hydromass.plots.estimate_P0" title="hydromass.plots.estimate_P0"><code class="xref py py-func docutils literal notranslate"><span class="pre">hydromass.plots.estimate_P0()</span></code></a> function, which fits a rough gNFW function to estimate the shape of the pressure profile and uses the fitted function to approximate the value of P0.</p></li>
<li><p><strong>tune</strong> (<em>int</em>) – Number of NUTS tuning steps. Defaults to 500</p></li>
<li><p><strong>dmonly</strong> (<em>bool</em>) – Specify whether the mass model is fitted to the total mass (dmonly=False) or to the dark matter only after subtracting the gas mass and the stellar mass if provided (dmonly=True). Defaults to False.</p></li>
<li><p><strong>mstar</strong> (<em>numpy.ndarray</em>) – If dmonly=True, provide an array containing the cumulative stellar mass profile, which will be subtracted when adjusting the mass model to the dark matter only.</p></li>
<li><p><strong>find_map</strong> (<em>bool</em>) – Specify whether a maximum likelihood fit will be performed first to initiate the sampler. Defaults to True</p></li>
<li><p><strong>pnt</strong> (<em>bool</em>) – Attempt to model the non-thermal pressure profile. If pnt=True, the non-thermal pressure profile of Angelinelli et al. 2020 and the corresponding parameters are used to marginalize over the impact of non-thermal pressure. Defaults to False.</p></li>
<li><p><strong>rmin</strong> (<em>float</em>) – Minimum limiting radius (in arcmin) of the active region for the surface brightness. If rmin=None, no minimum radius is applied. Defaults to None.</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – Maximum limiting radius (in arcmin) of the active region for the surface brightness. If rmax=None, no maximum radius is applied. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="hydromass.mhyd.Mhyd.run_GP">
<code class="sig-name descname"><span class="pre">run_GP</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bkglim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmcmc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_bkg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samplefile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbetas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">find_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngauss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/mhyd.html#Mhyd.run_GP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.mhyd.Mhyd.run_GP" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="hydromass.mhyd.Mhyd.run_forward">
<code class="sig-name descname"><span class="pre">run_forward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkglim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmcmc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_bkg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samplefile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbetas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">find_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/mhyd.html#Mhyd.run_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.mhyd.Mhyd.run_forward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="hydromass.mhyd.Mhyd.run_polytropic">
<code class="sig-name descname"><span class="pre">run_polytropic</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">polytropic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkglim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmcmc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_bkg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samplefile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbetas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">find_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/mhyd.html#Mhyd.run_polytropic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.mhyd.Mhyd.run_polytropic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="hydromass.mhyd.Run_Mhyd_PyMC3">
<code class="sig-prename descclassname"><span class="pre">hydromass.mhyd.</span></code><code class="sig-name descname"><span class="pre">Run_Mhyd_PyMC3</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkglim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmcmc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_bkg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samplefile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbetas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0_prior</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dmonly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mstar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">find_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pnt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/mhyd.html#Run_Mhyd_PyMC3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.mhyd.Run_Mhyd_PyMC3" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up hydrostatic mass model and optimize with PyMC3. The routine takes a parametric mass model as input and integrates the hydrostatic equilibrium equation to predict the 3D pressure profile:</p>
<div class="math notranslate nohighlight">
\[P_{3D}(r) = P_0 + \int_{r}^{r_0} \rho_{gas}(r) \frac{G M_{mod}(&lt;r)}{r^2} dr\]</div>
<p>with <span class="math notranslate nohighlight">\(r_0\)</span> the outer radial boundary of the input data and <span class="math notranslate nohighlight">\(P_0\)</span> the pressure at <span class="math notranslate nohighlight">\(r_0\)</span>.</p>
<p>The gas density profile is fitted to the surface brightness profile and described as a linear combination of King functions. The mass model should be defined using the <a class="reference internal" href="#hydromass.functions.Model" title="hydromass.functions.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.functions.Model</span></code></a> class, which implements a number of popular mass models. The 3D mass profile is then projected along the line of sight an weighted by spectroscopic-like weights to predict the spectroscopic temperature profile.</p>
<p>The parameters of the mass model and of the gas density profile are fitted jointly to the data. Priors on the input parameters can be set by the user in the definition of the mass model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – A <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object including the loaded data and initial setup (mandatory input)</p></li>
<li><p><strong>model</strong> (class:<cite>hydromass.functions.Model</cite>) – A <a class="reference internal" href="#hydromass.functions.Model" title="hydromass.functions.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.functions.Model</span></code></a> object including the chosen mass model and its input values (mandatory input)</p></li>
<li><p><strong>bkglim</strong> (<em>float</em>) – Limit (in arcmin) out to which the SB data will be fitted; if None then the whole range is considered. Defaults to None.</p></li>
<li><p><strong>nmcmc</strong> (<em>int</em>) – Number of PyMC3 steps. Defaults to 1000</p></li>
<li><p><strong>fit_bkg</strong> (<em>bool</em>) – Choose whether the counts and the background will be fitted on-the-fly using a Poisson model (fit_bkg=True) or if the surface brightness will be fitted, in which case it is assumed that the background has already been subtracted and Gaussian likelihood will be used (default = False)</p></li>
<li><p><strong>back</strong> (<em>float</em>) – Input value for the background. If None then the mean surface brightness in the region outside “bkglim” is used. Relevant only if fit_bkg = True. Defaults to None.</p></li>
<li><p><strong>samplefile</strong> (<em>str</em>) – Name of ASCII file to output the final PyMC3 samples</p></li>
<li><p><strong>nrc</strong> (<em>int</em>) – Number of core radii values to set up the multiscale model. Defaults to the number of data points / 4</p></li>
<li><p><strong>nbetas</strong> (<em>int</em>) – Number of beta values to set up the multiscale model (default = 6)</p></li>
<li><p><strong>min_beta</strong> (<em>float</em>) – Minimum beta value (default = 0.6)</p></li>
<li><p><strong>nmore</strong> (<em>int</em>) – Number of points to the define the fine grid onto which the mass model and the integration are performed, i.e. for one spectroscopic/SZ value, how many grid points will be defined. Defaults to 5.</p></li>
<li><p><strong>p0_prior</strong> (<em>numpy.ndarray</em>) – Set of two values defining the mean and standard deviation of the Gaussian prior on p0. If None, the code attempts to determine the value of P0 using the <a class="reference internal" href="#hydromass.plots.estimate_P0" title="hydromass.plots.estimate_P0"><code class="xref py py-func docutils literal notranslate"><span class="pre">hydromass.plots.estimate_P0()</span></code></a> function, which fits a rough gNFW function to estimate the shape of the pressure profile and uses the fitted function to approximate the value of P0.</p></li>
<li><p><strong>tune</strong> (<em>int</em>) – Number of NUTS tuning steps. Defaults to 500</p></li>
<li><p><strong>dmonly</strong> (<em>bool</em>) – Specify whether the mass model is fitted to the total mass (dmonly=False) or to the dark matter only after subtracting the gas mass and the stellar mass if provided (dmonly=True). Defaults to False.</p></li>
<li><p><strong>mstar</strong> (<em>numpy.ndarray</em>) – If dmonly=True, provide an array containing the cumulative stellar mass profile, which will be subtracted when adjusting the mass model to the dark matter only.</p></li>
<li><p><strong>find_map</strong> (<em>bool</em>) – Specify whether a maximum likelihood fit will be performed first to initiate the sampler. Defaults to True</p></li>
<li><p><strong>pnt</strong> (<em>bool</em>) – Attempt to model the non-thermal pressure profile. If pnt=True, the non-thermal pressure profile of Angelinelli et al. 2020 and the corresponding parameters are used to marginalize over the impact of non-thermal pressure. Defaults to False.</p></li>
<li><p><strong>rmin</strong> (<em>float</em>) – Minimum limiting radius (in arcmin) of the active region for the surface brightness. If rmin=None, no minimum radius is applied. Defaults to None.</p></li>
<li><p><strong>rmax</strong> (<em>float</em>) – Maximum limiting radius (in arcmin) of the active region for the surface brightness. If rmax=None, no maximum radius is applied. Defaults to None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-hydromass.nonparametric">
<span id="hydromass-nonparametric-module"></span><h2>hydromass.nonparametric module<a class="headerlink" href="#module-hydromass.nonparametric" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="hydromass.nonparametric.P_GP_from_samples">
<code class="sig-prename descclassname"><span class="pre">hydromass.nonparametric.</span></code><code class="sig-name descname"><span class="pre">P_GP_from_samples</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/nonparametric.html#P_GP_from_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.nonparametric.P_GP_from_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute model pressure profile from Forward Mhyd reconstruction evaluated at the reference SZ radii</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Mhyd</strong> – mhyd.Mhyd object including the reconstruction</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Median pressure, Lower 1-sigma percentile, Upper 1-sigma percentile</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.nonparametric.Run_NonParametric_PyMC3">
<code class="sig-prename descclassname"><span class="pre">hydromass.nonparametric.</span></code><code class="sig-name descname"><span class="pre">Run_NonParametric_PyMC3</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkglim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmcmc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_bkg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samplefile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbetas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ngauss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">find_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/nonparametric.html#Run_NonParametric_PyMC3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.nonparametric.Run_NonParametric_PyMC3" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> – </p></li>
<li><p><strong>bkglim</strong> – </p></li>
<li><p><strong>nmcmc</strong> – </p></li>
<li><p><strong>fit_bkg</strong> – </p></li>
<li><p><strong>back</strong> – </p></li>
<li><p><strong>samplefile</strong> – </p></li>
<li><p><strong>nrc</strong> – </p></li>
<li><p><strong>nbetas</strong> – </p></li>
<li><p><strong>min_beta</strong> – </p></li>
<li><p><strong>tune</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.nonparametric.calc_gp_grad_operator">
<code class="sig-prename descclassname"><span class="pre">hydromass.nonparametric.</span></code><code class="sig-name descname"><span class="pre">calc_gp_grad_operator</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/nonparametric.html#calc_gp_grad_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.nonparametric.calc_gp_grad_operator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.nonparametric.calc_gp_grad_operator_lognormal">
<code class="sig-prename descclassname"><span class="pre">hydromass.nonparametric.</span></code><code class="sig-name descname"><span class="pre">calc_gp_grad_operator_lognormal</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/nonparametric.html#calc_gp_grad_operator_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.nonparametric.calc_gp_grad_operator_lognormal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.nonparametric.calc_gp_operator">
<code class="sig-prename descclassname"><span class="pre">hydromass.nonparametric.</span></code><code class="sig-name descname"><span class="pre">calc_gp_operator</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/nonparametric.html#calc_gp_operator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.nonparametric.calc_gp_operator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.nonparametric.calc_gp_operator_lognormal">
<code class="sig-prename descclassname"><span class="pre">hydromass.nonparametric.</span></code><code class="sig-name descname"><span class="pre">calc_gp_operator_lognormal</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bin_fact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/nonparametric.html#calc_gp_operator_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.nonparametric.calc_gp_operator_lognormal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.nonparametric.kt_GP_from_samples">
<code class="sig-prename descclassname"><span class="pre">hydromass.nonparametric.</span></code><code class="sig-name descname"><span class="pre">kt_GP_from_samples</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/nonparametric.html#kt_GP_from_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.nonparametric.kt_GP_from_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute model temperature profile from Forward Mhyd reconstruction evaluated at reference X-ray temperature radii</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> – mhyd.Mhyd object including the reconstruction</p></li>
<li><p><strong>model</strong> – mhyd.Model object defining the mass model</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Median temperature, Lower 1-sigma percentile, Upper 1-sigma percentile</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.nonparametric.mass_GP_from_samples">
<code class="sig-prename descclassname"><span class="pre">hydromass.nonparametric.</span></code><code class="sig-name descname"><span class="pre">mass_GP_from_samples</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/nonparametric.html#mass_GP_from_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.nonparametric.mass_GP_from_samples" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.nonparametric.prof_GP_hires">
<code class="sig-prename descclassname"><span class="pre">hydromass.nonparametric.</span></code><code class="sig-name descname"><span class="pre">prof_GP_hires</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/nonparametric.html#prof_GP_hires"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.nonparametric.prof_GP_hires" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute best-fitting profiles and error envelopes from fitted data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> – (hydromass.Mhyd) Object containing results of mass reconstruction</p></li>
<li><p><strong>model</strong> – </p></li>
<li><p><strong>nmore</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-hydromass.plots">
<span id="hydromass-plots-module"></span><h2>hydromass.plots module<a class="headerlink" href="#module-hydromass.plots" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="hydromass.plots.P_from_samples">
<code class="sig-prename descclassname"><span class="pre">hydromass.plots.</span></code><code class="sig-name descname"><span class="pre">P_from_samples</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/plots.html#P_from_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.plots.P_from_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute model pressure profile from an existing mass reconstruction run and evaluate it at the reference SZ radii</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – A <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object containing the result of a mass model fit</p></li>
<li><p><strong>model</strong> (class:<cite>hydromass.functions.Model</cite>) – A <a class="reference internal" href="#hydromass.functions.Model" title="hydromass.functions.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.functions.Model</span></code></a> object containing the definition of the mass model</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Arrays containing the median 3D pressure profile and the 16th and 84th percentiles</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.plots.PlotMgas">
<code class="sig-prename descclassname"><span class="pre">hydromass.plots.</span></code><code class="sig-name descname"><span class="pre">PlotMgas</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/plots.html#PlotMgas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.plots.PlotMgas" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute Mgas profile and error envelope from mass reconstruction run</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – A <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object containing the result of a mass model fit</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – Plot the gas mass profile. Defaults to False</p></li>
<li><p><strong>outfile</strong> (<em>str</em>) – If plot=True, file name to output the plotted Mgas profile. If none, the plot is displayed on stdout. Defaults to None</p></li>
<li><p><strong>nmore</strong> (<em>int</em>) – Number of points defining fine grid, must be equal to the value used for the mass reconstruction. Defaults to 5</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>1-D arrays containing the median gas mass and 16th and 84th percentiles. If plot=True, a matplotlib figure is also returned.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.plots.cumsum_mat">
<code class="sig-prename descclassname"><span class="pre">hydromass.plots.</span></code><code class="sig-name descname"><span class="pre">cumsum_mat</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nval</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/plots.html#cumsum_mat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.plots.cumsum_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to create a matrix that flips a vector, makes a cumulative sum and adds a 0 as the first element
Then dot(mat, vector) returns the Riemann integral as a cumulative sum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nval</strong> (<em>numpy.ndarray</em>) – Vector size</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Cumulative sum operator</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.plots.densout_pout_from_samples">
<code class="sig-prename descclassname"><span class="pre">hydromass.plots.</span></code><code class="sig-name descname"><span class="pre">densout_pout_from_samples</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rin_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rout_m</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/plots.html#densout_pout_from_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.plots.densout_pout_from_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the model 3D density and pressure profiles from the output NUTS sample on an arbitrary output grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – A <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object containing the result of a mass model fit</p></li>
<li><p><strong>model</strong> (class:<cite>hydromass.functions.Model</cite>) – A <a class="reference internal" href="#hydromass.functions.Model" title="hydromass.functions.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.functions.Model</span></code></a> object containing the definition of the mass model</p></li>
<li><p><strong>rin_m</strong> (<em>numpy.ndarray</em>) – A 1-D array containing the inner boundaries of the chosen bins</p></li>
<li><p><strong>rout_m</strong> (<em>numpy.ndarray</em>) – A 1-D array containing the outer boundaries of the chosen bins</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>dens_m: A 2-D array containing the gas density profiles for all the samples</p></li>
<li><p>press_out: A 2-D array containing the total 3D pressure profile</p></li>
<li><p>pth: A 2-D array containing the thermal pressure profile. If non-thermal pressure is not modeled then this is equal to the total pressure</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.plots.estimate_P0">
<code class="sig-prename descclassname"><span class="pre">hydromass.plots.</span></code><code class="sig-name descname"><span class="pre">estimate_P0</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/plots.html#estimate_P0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.plots.estimate_P0" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide an estimate of the pressure at the outer boundary by fitting a rough gNFW profile to the data. A rough electron density profile is estimated by deprojecting the surface brightness profile using the onion peeling techique, and temperature deprojection is neglected. The resulting pressure profile is fitted with a gNFW profile using the scipy.minimize function and the best-fit function is used to extrapolate the pressure to the outer boundary to provide a rough estimate of <span class="math notranslate nohighlight">\(P_0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – A <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object containing the loaded data</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Estimated value of <span class="math notranslate nohighlight">\(P_0\)</span></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.plots.get_coolfunc">
<code class="sig-prename descclassname"><span class="pre">hydromass.plots.</span></code><code class="sig-name descname"><span class="pre">get_coolfunc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/plots.html#get_coolfunc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.plots.get_coolfunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the cooling function data from the internal data archive and return the cooling function profile for a given input metallicity</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Z</strong> (<em>float</em>) – Metallicity (relative to Anders &amp; Grevesse; defaults to 0.3)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Cooling function profile and temperature grid</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.plots.gnfw_p0">
<code class="sig-prename descclassname"><span class="pre">hydromass.plots.</span></code><code class="sig-name descname"><span class="pre">gnfw_p0</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/plots.html#gnfw_p0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.plots.gnfw_p0" title="Permalink to this definition">¶</a></dt>
<dd><p>Generalized NFW function to estimate the pressure at the outer boundary, P0</p>
<div class="math notranslate nohighlight">
\[P_{gNFW}(r) = \frac{P_0} {(r/r_s)^\gamma (1+(r/rs)^\alpha)^{(\beta-\gamma)/\alpha}}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>numpy.ndarray</em>) – Radius</p></li>
<li><p><strong>pars</strong> (<em>numpy.ndarray</em>) – Array containing the five parameters (P0, rs, alpha, beta, and gamma) of the gNFW function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Model pressure</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.plots.kt_from_samples">
<code class="sig-prename descclassname"><span class="pre">hydromass.plots.</span></code><code class="sig-name descname"><span class="pre">kt_from_samples</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/plots.html#kt_from_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.plots.kt_from_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute model temperature profile from a mass reconstruction run, evaluated at reference X-ray temperature radii</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – A <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object containing the result of a mass model fit</p></li>
<li><p><strong>model</strong> (class:<cite>hydromass.functions.Model</cite>) – A <a class="reference internal" href="#hydromass.functions.Model" title="hydromass.functions.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.functions.Model</span></code></a> object containing the definition of the mass model</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary containing the model temperature profile and uncertainties, 3D and spectroscopic-like</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict(9xnval)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.plots.mass_from_samples">
<code class="sig-prename descclassname"><span class="pre">hydromass.plots.</span></code><code class="sig-name descname"><span class="pre">mass_from_samples</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/plots.html#mass_from_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.plots.mass_from_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the median and percentile mass profile, gas mass and gas fraction from an existing mass reconstruction run</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – A <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object containing the result of a mass model fit</p></li>
<li><p><strong>model</strong> (class:<cite>hydromass.functions.Model</cite>) – A <a class="reference internal" href="#hydromass.functions.Model" title="hydromass.functions.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.functions.Model</span></code></a> object containing the definition of the mass model</p></li>
<li><p><strong>rin</strong> (<em>float</em>) – Minimum radius of the output profiles</p></li>
<li><p><strong>rout</strong> (<em>float</em>) – Maximum radius of the output profiles</p></li>
<li><p><strong>npt</strong> (<em>int</em>) – Number of radial points in the output profiles. Defaults to 200</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – Plot the mass and gas mass profiles and return a matplotlib figure. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary containing the median mass [in M_sun], Lower 1-sigma percentile, Upper 1-sigma percentile, Median Mgas, Lower, Upper, Median Fgas, Lower, Upper</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict(16xnpt)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.plots.mgas_pm">
<code class="sig-prename descclassname"><span class="pre">hydromass.plots.</span></code><code class="sig-name descname"><span class="pre">mgas_pm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rin_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rout_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dens</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/plots.html#mgas_pm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.plots.mgas_pm" title="Permalink to this definition">¶</a></dt>
<dd><p>Theano function to compute the gas mass</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rin_m</strong> (<em>numpy.ndarray</em>) – 1-D array containing the inner edges of radial bins</p></li>
<li><p><strong>rout_m</strong> (<em>numpy.ndarray</em>) – 1-D array containing the outer edges of radial bins</p></li>
<li><p><strong>dens</strong> (<em>theano.tensor</em>) – Theano tensor including the density profile evaluated at the chosen radial bins</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Cumulative gas mass profile</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>theano.tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.plots.prof_hires">
<code class="sig-prename descclassname"><span class="pre">hydromass.plots.</span></code><code class="sig-name descname"><span class="pre">prof_hires</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">npt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/plots.html#prof_hires"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.plots.prof_hires" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute best-fitting thermodynamic profiles and error envelopes from an existing mass reconstruction run</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – A <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object containing the result of a mass model fit</p></li>
<li><p><strong>model</strong> (class:<cite>hydromass.functions.Model</cite>) – A <a class="reference internal" href="#hydromass.functions.Model" title="hydromass.functions.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.functions.Model</span></code></a> object containing the definition of the mass model</p></li>
<li><p><strong>rin</strong> (<em>float</em>) – Minimum radius of the output profiles</p></li>
<li><p><strong>npt</strong> (<em>int</em>) – Number of radial points in the output profiles. Defaults to 200</p></li>
<li><p><strong>Z</strong> (<em>float</em>) – Gas metallicity for cooling function calculation. Defaults to 0.3</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary containing the median profiles and 1-sigma percentiles of temperature, pressure, gas density, entropy, and cooling time</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict(30xnpt)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.plots.rads_more">
<code class="sig-prename descclassname"><span class="pre">hydromass.plots.</span></code><code class="sig-name descname"><span class="pre">rads_more</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/plots.html#rads_more"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.plots.rads_more" title="Permalink to this definition">¶</a></dt>
<dd><p>Return grid of (in, out) radii from X-ray, SZ data or both. Concatenates radii if necessary, then computes a grid of radii.
Returns the output arrays and the indices corresponding to the input X-ray and/or SZ radii.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – A <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object containing loaded X-ray and/or SZ loaded data.</p></li>
<li><p><strong>nmore</strong> (<em>int</em>) – Number of subgrid values to compute the fine binning. Each input bin will be split into nmore values. Defaults to 5.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>rin, rout: the inner and outer radii of the fine grid</p></li>
<li><p>index_x, index_sz: lists of indices corresponding to the position of the input values in the grid</p></li>
<li><p>sum_mat: matrix containing the number of values in each subgrid bin</p></li>
<li><p>ntm: total number of grid points</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-hydromass.pnt">
<span id="hydromass-pnt-module"></span><h2>hydromass.pnt module<a class="headerlink" href="#module-hydromass.pnt" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="hydromass.pnt.alpha_turb_np">
<code class="sig-prename descclassname"><span class="pre">hydromass.pnt.</span></code><code class="sig-name descname"><span class="pre">alpha_turb_np</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pnt_pars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/pnt.html#alpha_turb_np"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.pnt.alpha_turb_np" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.pnt.alpha_turb_pm">
<code class="sig-prename descclassname"><span class="pre">hydromass.pnt.</span></code><code class="sig-name descname"><span class="pre">alpha_turb_pm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r200c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/pnt.html#alpha_turb_pm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.pnt.alpha_turb_pm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.pnt.get_data_file_path">
<code class="sig-prename descclassname"><span class="pre">hydromass.pnt.</span></code><code class="sig-name descname"><span class="pre">get_data_file_path</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/pnt.html#get_data_file_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.pnt.get_data_file_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the absolute path to the required data files.
:param data_file: relative path to the data file, relative to the astromodels/data path.
So to get the path to data/dark_matter/gammamc_dif.dat you need to use data_file=”dark_matter/gammamc_dif.dat”
:return: absolute path of the data file</p>
</dd></dl>

<dl class="py function">
<dt id="hydromass.pnt.r200m_from_params">
<code class="sig-prename descclassname"><span class="pre">hydromass.pnt.</span></code><code class="sig-name descname"><span class="pre">r200m_from_params</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">c</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/pnt.html#r200m_from_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.pnt.r200m_from_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-hydromass.polytropic">
<span id="hydromass-polytropic-module"></span><h2>hydromass.polytropic module<a class="headerlink" href="#module-hydromass.polytropic" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="hydromass.polytropic.P_poly_from_samples">
<code class="sig-prename descclassname"><span class="pre">hydromass.polytropic.</span></code><code class="sig-name descname"><span class="pre">P_poly_from_samples</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Polytropic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/polytropic.html#P_poly_from_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.polytropic.P_poly_from_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute model pressure profile from Forward Mhyd reconstruction evaluated at the reference SZ radii</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> – mhyd.Mhyd object including the reconstruction</p></li>
<li><p><strong>model</strong> – mhyd.Model object defining the mass model</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Median pressure, Lower 1-sigma percentile, Upper 1-sigma percentile</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="hydromass.polytropic.Polytropic">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydromass.polytropic.</span></code><code class="sig-name descname"><span class="pre">Polytropic</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limits</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/polytropic.html#Polytropic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.polytropic.Polytropic" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="py function">
<dt id="hydromass.polytropic.Run_Polytropic_PyMC3">
<code class="sig-prename descclassname"><span class="pre">hydromass.polytropic.</span></code><code class="sig-name descname"><span class="pre">Run_Polytropic_PyMC3</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Polytropic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkglim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmcmc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_bkg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">back</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samplefile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbetas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">find_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/polytropic.html#Run_Polytropic_PyMC3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.polytropic.Run_Polytropic_PyMC3" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> – </p></li>
<li><p><strong>bkglim</strong> – </p></li>
<li><p><strong>nmcmc</strong> – </p></li>
<li><p><strong>fit_bkg</strong> – </p></li>
<li><p><strong>back</strong> – </p></li>
<li><p><strong>samplefile</strong> – </p></li>
<li><p><strong>nrc</strong> – </p></li>
<li><p><strong>nbetas</strong> – </p></li>
<li><p><strong>min_beta</strong> – </p></li>
<li><p><strong>tune</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.polytropic.func_poly_dens_np">
<code class="sig-prename descclassname"><span class="pre">hydromass.polytropic.</span></code><code class="sig-name descname"><span class="pre">func_poly_dens_np</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_dens</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/polytropic.html#func_poly_dens_np"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.polytropic.func_poly_dens_np" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.polytropic.func_poly_dens_pm">
<code class="sig-prename descclassname"><span class="pre">hydromass.polytropic.</span></code><code class="sig-name descname"><span class="pre">func_poly_dens_pm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_dens</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/polytropic.html#func_poly_dens_pm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.polytropic.func_poly_dens_pm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.polytropic.func_poly_rad_np">
<code class="sig-prename descclassname"><span class="pre">hydromass.polytropic.</span></code><code class="sig-name descname"><span class="pre">func_poly_rad_np</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_dens</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/polytropic.html#func_poly_rad_np"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.polytropic.func_poly_rad_np" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.polytropic.func_poly_rad_pm">
<code class="sig-prename descclassname"><span class="pre">hydromass.polytropic.</span></code><code class="sig-name descname"><span class="pre">func_poly_rad_pm</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_dens</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/polytropic.html#func_poly_rad_pm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.polytropic.func_poly_rad_pm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.polytropic.gradP_gamman">
<code class="sig-prename descclassname"><span class="pre">hydromass.polytropic.</span></code><code class="sig-name descname"><span class="pre">gradP_gamman</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xout</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pars</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad_dens</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/polytropic.html#gradP_gamman"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.polytropic.gradP_gamman" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.polytropic.kt_poly_from_samples">
<code class="sig-prename descclassname"><span class="pre">hydromass.polytropic.</span></code><code class="sig-name descname"><span class="pre">kt_poly_from_samples</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Polytropic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/polytropic.html#kt_poly_from_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.polytropic.kt_poly_from_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute model temperature profile from Forward Mhyd reconstruction evaluated at reference X-ray temperature radii</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> – mhyd.Mhyd object including the reconstruction</p></li>
<li><p><strong>model</strong> – mhyd.Model object defining the mass model</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Median temperature, Lower 1-sigma percentile, Upper 1-sigma percentile</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.polytropic.mass_poly_from_samples">
<code class="sig-prename descclassname"><span class="pre">hydromass.polytropic.</span></code><code class="sig-name descname"><span class="pre">mass_poly_from_samples</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Polytropic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/polytropic.html#mass_poly_from_samples"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.polytropic.mass_poly_from_samples" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="hydromass.polytropic.prof_poly_hires">
<code class="sig-prename descclassname"><span class="pre">hydromass.polytropic.</span></code><code class="sig-name descname"><span class="pre">prof_poly_hires</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Polytropic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nmore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/polytropic.html#prof_poly_hires"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.polytropic.prof_poly_hires" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute best-fitting profiles and error envelopes from fitted data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> – (hydromass.Mhyd) Object containing results of mass reconstruction</p></li>
<li><p><strong>model</strong> – </p></li>
<li><p><strong>nmore</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-hydromass.save">
<span id="hydromass-save-module"></span><h2>hydromass.save module<a class="headerlink" href="#module-hydromass.save" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="hydromass.save.ReloadForward">
<code class="sig-prename descclassname"><span class="pre">hydromass.save.</span></code><code class="sig-name descname"><span class="pre">ReloadForward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/save.html#ReloadForward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.save.ReloadForward" title="Permalink to this definition">¶</a></dt>
<dd><p>Reload the results of a previous forward fit saved using the <a class="reference internal" href="#hydromass.save.SaveForward" title="hydromass.save.SaveForward"><code class="xref py py-func docutils literal notranslate"><span class="pre">hydromass.save.SaveForward()</span></code></a> function into the current live session</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – A <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object into which the previously saved data will be stored</p></li>
<li><p><strong>infile</strong> (<em>str</em>) – Name of input FITS file containing the data saved using the <a class="reference internal" href="#hydromass.save.SaveForward" title="hydromass.save.SaveForward"><code class="xref py py-func docutils literal notranslate"><span class="pre">hydromass.save.SaveForward()</span></code></a> function</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.save.ReloadGP">
<code class="sig-prename descclassname"><span class="pre">hydromass.save.</span></code><code class="sig-name descname"><span class="pre">ReloadGP</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/save.html#ReloadGP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.save.ReloadGP" title="Permalink to this definition">¶</a></dt>
<dd><p>Reload the result of a non-parametric GP reconstruction previously saved using the <a class="reference internal" href="#hydromass.save.SaveGP" title="hydromass.save.SaveGP"><code class="xref py py-func docutils literal notranslate"><span class="pre">hydromass.save.SaveGP()</span></code></a> function into the current session.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – A <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object into which the previously saved data will be stored</p></li>
<li><p><strong>infile</strong> (<em>str</em>) – Name of input FITS file containing the data saved using the <a class="reference internal" href="#hydromass.save.SaveGP" title="hydromass.save.SaveGP"><code class="xref py py-func docutils literal notranslate"><span class="pre">hydromass.save.SaveGP()</span></code></a> function</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.save.ReloadModel">
<code class="sig-prename descclassname"><span class="pre">hydromass.save.</span></code><code class="sig-name descname"><span class="pre">ReloadModel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mstar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/save.html#ReloadModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.save.ReloadModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Reload the result of a previous mass model fit within the current live session after it has been saved using the <a class="reference internal" href="#hydromass.save.SaveModel" title="hydromass.save.SaveModel"><code class="xref py py-func docutils literal notranslate"><span class="pre">hydromass.save.SaveModel()</span></code></a> function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – A <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object into which the previously saved data will be stored</p></li>
<li><p><strong>infile</strong> (<em>str</em>) – Name of input FITS file containing the data saved using the <a class="reference internal" href="#hydromass.save.SaveModel" title="hydromass.save.SaveModel"><code class="xref py py-func docutils literal notranslate"><span class="pre">hydromass.save.SaveModel()</span></code></a> function</p></li>
<li><p><strong>mstar</strong> (class:<cite>numpy.ndarray</cite>) – External cumulative stellar mass profile if available. If none, no stellar mass profile is used. Defaults to none</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference internal" href="#hydromass.functions.Model" title="hydromass.functions.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.functions.Model</span></code></a> object with the model definition and parameters</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>class:<cite>hydromass.functions.Model</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.save.SaveForward">
<code class="sig-prename descclassname"><span class="pre">hydromass.save.</span></code><code class="sig-name descname"><span class="pre">SaveForward</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Forward</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/save.html#SaveForward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.save.SaveForward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – A <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object containing the definition of the fitted data and the output of the forward fit</p></li>
<li><p><strong>Forward</strong> (class:<cite>hydromass.forward.Forward</cite>) – A <a class="reference internal" href="#hydromass.forward.Forward" title="hydromass.forward.Forward"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.forward.Forward</span></code></a> object containing the definition of the forward model</p></li>
<li><p><strong>outfile</strong> (<em>str</em>) – Name of output FITS file. If none, the file is outputted to a file called “output_forward.fits” under the default output directory specified in the <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object. Defaults to none</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.save.SaveGP">
<code class="sig-prename descclassname"><span class="pre">hydromass.save.</span></code><code class="sig-name descname"><span class="pre">SaveGP</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/save.html#SaveGP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.save.SaveGP" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the result of a non-parametric GP reconstruction into an output FITS file. The result can be later reloaded through the <a class="reference internal" href="#hydromass.save.ReloadGP" title="hydromass.save.ReloadGP"><code class="xref py py-func docutils literal notranslate"><span class="pre">hydromass.save.ReloadGP()</span></code></a> function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – A <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object containing the definition of the fitted data and and the output of the non-parametric GP reconstruction</p></li>
<li><p><strong>outfile</strong> (<em>str</em>) – Name of output FITS file. If none, the file is outputted to a file called “output_GP.fits” under the default output directory specified in the <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object. Defaults to none</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.save.SaveModel">
<code class="sig-prename descclassname"><span class="pre">hydromass.save.</span></code><code class="sig-name descname"><span class="pre">SaveModel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Mhyd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/save.html#SaveModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.save.SaveModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the output chains of a fitted mass model to an output file. The output file can then be reloaded into a new Mhyd object using the <a class="reference internal" href="#hydromass.save.ReloadModel" title="hydromass.save.ReloadModel"><code class="xref py py-func docutils literal notranslate"><span class="pre">hydromass.save.ReloadModel()</span></code></a> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Mhyd</strong> (class:<cite>hydromass.mhyd.Mhyd</cite>) – A <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object containing the definition of the fitted data and and the output of the mass model fit</p></li>
<li><p><strong>model</strong> (class:<cite>hydromass.functions.Model</cite>) – A <a class="reference internal" href="#hydromass.functions.Model" title="hydromass.functions.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.functions.Model</span></code></a> object containing the definition of the mass model</p></li>
<li><p><strong>outfile</strong> (<em>str</em>) – Name of output FITS file. If none, the file is outputted to a file called “output_model.fits” under the default output directory specified in the <a class="reference internal" href="#hydromass.mhyd.Mhyd" title="hydromass.mhyd.Mhyd"><code class="xref py py-class docutils literal notranslate"><span class="pre">hydromass.mhyd.Mhyd</span></code></a> object. Defaults to none</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="hydromass.save.SaveProfiles">
<code class="sig-prename descclassname"><span class="pre">hydromass.save.</span></code><code class="sig-name descname"><span class="pre">SaveProfiles</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">profiles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'THERMODYNAMIC</span> <span class="pre">PROFILES'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/save.html#SaveProfiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.save.SaveProfiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the profiles loaded into a profile dictionary into an output FITS file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>profiles</strong> (<em>dict</em>) – Dictionary containing profiles and profile names</p></li>
<li><p><strong>outfile</strong> (<em>str</em>) – Output FITS file name</p></li>
<li><p><strong>extname</strong> (<em>str</em>) – Name of the extension of the FITS file containing the output data. Defaults to “THERMODYNAMIC PROFILES”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-hydromass.tpdata">
<span id="hydromass-tpdata-module"></span><h2>hydromass.tpdata module<a class="headerlink" href="#module-hydromass.tpdata" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="hydromass.tpdata.SZData">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydromass.tpdata.</span></code><code class="sig-name descname"><span class="pre">SZData</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">redshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sz_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covmat_sz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/tpdata.html#SZData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.tpdata.SZData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container class to load a SZ pressure profile and its covariance matrix. The data can either be passed all at once by reading a FITS table file or directly as numpy arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>redshift</strong> (<em>float</em>) – Source redshift</p></li>
<li><p><strong>sz_data</strong> (<em>str</em>) – Link to a FITS file containing the SZ pressure profile to be read. If None, the values should be passed directly as numpy arrays through the rin, rout, kt, err_kt_low, and err_kt_high arguments. Defaults to None</p></li>
<li><p><strong>rin</strong> (<em>numpy.ndarray</em>) – 1-D array including the inner boundary definition of the SZ bins (in kpc). If None, the data should be passed as a FITS file using the sz_data argument. Defaults to None</p></li>
<li><p><strong>rout</strong> – 1-D array including the outer boundary definition of the SZ bins (in kpc). If None, the data should be passed as a FITS file using the sz_data argument. Defaults to None</p></li>
<li><p><strong>psz</strong> (<em>numpy.ndarray</em>) – 1-D array containing the SZ pressure profile (in keV cm^-3). If None, the data should be passed as a FITS file using the sz_data argument. Defaults to None</p></li>
<li><p><strong>covmat_sz</strong> (<em>numpy.ndarray</em>) – 2-D array containing the covariance matrix on the SZ pressure profile. If None, the data should be passed as a FITS file using the sz_data argument. Defaults to None</p></li>
<li><p><strong>cosmo</strong> (<em>astropy.cosmology</em>) – Astropy cosmology object including the cosmology definition</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="hydromass.tpdata.SZData.PSF">
<code class="sig-name descname"><span class="pre">PSF</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pixsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psffunc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psffile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psfimage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psfpixsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sourcemodel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psfmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/tpdata.html#SZData.PSF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.tpdata.SZData.PSF" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a point spread function (PSF) mixing matrix for the loaded SZ data. Each row of the PSF mixing matrix corresponding to a given annulus is computed by defining a normalized image into the annulus and zeros elsewhere. The image is then convolved with the PSF model using FFT. See Eckert et al. 2020 for details.</p>
<p>The PSF model can be provided either in the form of a one-dimensional radial function or of an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pixsize</strong> (<em>float</em>) – Pixel size in arcmin</p></li>
<li><p><strong>psffunc</strong> (<em>func</em>) – 1D function transforming an array of radii into the PSF model value. If None, an image should be provided. Defaults to None.</p></li>
<li><p><strong>psffile</strong> (<em>str</em>) – FITS file containing the model PSF image. If None, the PSF should be provided either as a 1D function or a 2D array. Defaults to None.</p></li>
<li><p><strong>psfimage</strong> (<em>numpy.ndarray</em>) – 2-D array containing an image of the PSF. The pixel size should be passed through the “psfpixsize” argument. If None, the PSF should be provided either as a 1D function or a FITS image. Defaults to None.</p></li>
<li><p><strong>psfpixsize</strong> (<em>float</em>) – Image pixel size (in arcmin) in case a PSF image is provided.</p></li>
<li><p><strong>sourcemodel</strong> (<em>pyproffit.models.model</em>) – A pyproffit model describing the radial dependence of the emissivity distribution. If provided, the PSF at each point is weighted by the radial model to take the emissivity gradient across the bins into account when computing the PSF mixing matrix. If None, a flat distribution is assumed. Defaults to None.</p></li>
<li><p><strong>psfmin</strong> (<em>float</em>) – Minimum PSF value (relative to the maximum) below which the effect of the PSF is neglected. Increasing psfmin speeds up the computation at the cost of a lower precision.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="hydromass.tpdata.SpecData">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">hydromass.tpdata.</span></code><code class="sig-name descname"><span class="pre">SpecData</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">redshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spec_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_kt_low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">err_kt_high</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/tpdata.html#SpecData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.tpdata.SpecData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Container class to load a spectroscopic temperature profile and its uncertainties. The data can either be passed all at once by reading a FITS table file or directly as numpy arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>redshift</strong> (<em>float</em>) – Source redshift</p></li>
<li><p><strong>spec_data</strong> (<em>str</em>) – Link to a FITS file containing the spectroscopic temperature profile to be read. The FITS table should contain the following fields: ‘RIN’, ‘ROUT’, ‘KT’, ‘KT_LO’, and ‘KT_HI’ (see the description below). If None, the values should be passed directly as numpy arrays through the rin, rout, kt, err_kt_low, and err_kt_high arguments. Defaults to None</p></li>
<li><p><strong>rin</strong> (<em>numpy.ndarray</em>) – 1-D array including the inner boundary definition of the spectroscopic bins (in arcmin). If None, the data should be passed as a FITS file using the spec_data argument. Defaults to None</p></li>
<li><p><strong>rout</strong> – 1-D array including the outer boundary definition of the spectroscopic bins (in arcmin). If None, the data should be passed as a FITS file using the spec_data argument. Defaults to None</p></li>
<li><p><strong>kt</strong> (<em>numpy.ndarray</em>) – 1-D array containing the fitted spectroscopic temperature (in keV). If None, the data should be passed as a FITS file using the spec_data argument. Defaults to None</p></li>
<li><p><strong>err_kt_low</strong> (<em>numpy.ndarray</em>) – 1-D array containing the lower 1-sigma error on the fitted spectroscopic temperature (in keV). If None, the data should be passed as a FITS file using the spec_data argument. Defaults to None</p></li>
<li><p><strong>err_kt_high</strong> (<em>numpy.ndarray</em>) – 1-D array containing the upper 1-sigma error on the fitted spectroscopic temperature (in keV). If None, the data should be passed as a FITS file using the spec_data argument. Defaults to None</p></li>
<li><p><strong>cosmo</strong> (<em>astropy.cosmology</em>) – Astropy cosmology object including the cosmology definition</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="hydromass.tpdata.SpecData.PSF">
<code class="sig-name descname"><span class="pre">PSF</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pixsize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psffunc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psffile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psfimage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psfpixsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sourcemodel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psfmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-07</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/hydromass/tpdata.html#SpecData.PSF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hydromass.tpdata.SpecData.PSF" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a point spread function (PSF) mixing matrix for the loaded spectroscopic data. Each row of the PSF mixing matrix corresponding to a given annulus is computed by defining a normalized image into the annulus and zeros elsewhere. The image is then convolved with the PSF model using FFT. See Eckert et al. 2020 for details.</p>
<p>The PSF model can be provided either in the form of a one-dimensional radial function or of an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pixsize</strong> (<em>float</em>) – Pixel size in arcmin</p></li>
<li><p><strong>psffunc</strong> (<em>func</em>) – 1D function transforming an array of radii into the PSF model value. If None, an image should be provided. Defaults to None.</p></li>
<li><p><strong>psffile</strong> (<em>str</em>) – FITS file containing the model PSF image. If None, the PSF should be provided either as a 1D function or a 2D array. Defaults to None.</p></li>
<li><p><strong>psfimage</strong> (<em>numpy.ndarray</em>) – 2-D array containing an image of the PSF. The pixel size should be passed through the “psfpixsize” argument. If None, the PSF should be provided either as a 1D function or a FITS image. Defaults to None.</p></li>
<li><p><strong>psfpixsize</strong> (<em>float</em>) – Image pixel size (in arcmin) in case a PSF image is provided.</p></li>
<li><p><strong>sourcemodel</strong> (<em>pyproffit.models.model</em>) – A pyproffit model describing the radial dependence of the emissivity distribution. If provided, the PSF at each point is weighted by the radial model to take the emissivity gradient across the bins into account when computing the PSF mixing matrix. If None, a flat distribution is assumed. Defaults to None.</p></li>
<li><p><strong>psfmin</strong> (<em>float</em>) – Minimum PSF value (relative to the maximum) below which the effect of the PSF is neglected. Increasing psfmin speeds up the computation at the cost of a lower precision.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-hydromass">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-hydromass" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="tutorials.html" class="btn btn-neutral float-left" title="Tutorials" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2022, D. Eckert

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>